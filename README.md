# InfoWatchdog - Agent de Veille Environnementale

<div align="center">
  <p>
  <a href="https://github.com/yemal22/info-watchdog">
    <img src="https://img.shields.io/badge/status-active-green.svg" alt="Status">
  </a>
  <a href="https://github.com/yemal22/info-watchdog/releases">
    <img src="https://img.shields.io/badge/version-1.0.0-blue.svg" alt="Version">
  </a>
  <a href="https://opensource.org/licenses/MIT">
    <img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT">
  </a>
  <a href="https://www.python.org/downloads/">
    <img src="https://img.shields.io/badge/python-3.8+-blue.svg" alt="Python 3.8+">
  </a>
  <a href="https://github.com/psf/black">
    <img src="https://img.shields.io/badge/code%20style-black-000000.svg" alt="Code Style">
  </a>
  <img src="https://img.shields.io/badge/platform-linux%20|%20macos%20|%20windows-lightgrey.svg" alt="Platform">
  <a href="https://www.reddit.com/dev/api/">
    <img src="https://img.shields.io/badge/API-Reddit-FF4500.svg" alt="Reddit API">
  </a>
  <img src="https://img.shields.io/badge/Feeds-RSS-FFA500.svg" alt="RSS Feeds">
  <a href="https://airtable.com/">
    <img src="https://img.shields.io/badge/Database-Airtable-18BFFF.svg" alt="Airtable">
  </a>
  <img src="https://img.shields.io/badge/automation-cron%20|%20systemd%20|%20windows-green.svg" alt="Automation">
  <img src="https://img.shields.io/badge/focus-environmental%20news-32CD32.svg" alt="Environmental Focus">
  <img src="https://img.shields.io/badge/collection-automated-brightgreen.svg" alt="Automated Collection">
  <img src="https://img.shields.io/badge/duplicates-protected-orange.svg" alt="Duplicate Guard">
  <img src="https://img.shields.io/badge/monitoring-24%2F7-red.svg" alt="24/7 Monitoring">
  <img src="https://img.shields.io/badge/sources-reddit%20%2B%20rss-blue.svg" alt="Multi Source">
  <a href="https://streamlit.io/">
    <img src="https://img.shields.io/badge/dashboard-streamlit-FF4B4B.svg" alt="Streamlit Dashboard">
  </a>
</p>
  
  <br><br>
  <img src="assets/logo-static.svg" alt="InfoWatchdog Logo" width="400"/>
</div>

**InfoWatchdog** est un agent automatique de collecte et de veille d'actualit√©s environnementales depuis multiples sources (Reddit, RSS) avec stockage structur√© dans Airtable.

---

## üéØ Objectif

InfoWatchdog surveille automatiquement l'actualit√© environnementale en collectant des contenus r√©cents depuis diverses sources et les stocke de mani√®re structur√©e pour faciliter l'analyse et le suivi des tendances.

## üìä Dashboard Temps R√©el

InfoWatchdog inclut un **dashboard Streamlit interactif** pour surveiller vos donn√©es en temps r√©el !

### üöÄ Lancement rapide du dashboard
```bash
# M√©thode simple
python run_dashboard.py

# Ou directement avec Streamlit
streamlit run dashboard_streamlit.py
```

### üé® Fonctionnalit√©s du dashboard

#### üìà Visualisations en temps r√©el
- **M√©triques principales** : Articles collect√©s, r√©partition par source, activit√© r√©cente
- **Graphiques temporels** : Evolution quotidienne des collectes
- **Graphiques en secteurs** : R√©partition par sources RSS et subreddits Reddit
- **Heatmap d'activit√©** : Patterns de collecte par heure et jour de la semaine

#### üîç Analyse des donn√©es
- **Articles r√©cents** : Liste des derni√®res collectes avec scores Reddit
- **Sources tendances** : Top sources sur 7 jours
- **Top subreddits** : Subreddits les plus actifs
- **Statistiques d√©taill√©es** : Performance par collecteur, scores moyens

#### ‚öôÔ∏è Contr√¥les interactifs
- **Filtrage par p√©riode** : 7j, 30j, 90j ou toutes les donn√©es
- **Actualisation automatique** : Mise √† jour toutes les 30 secondes
- **Cache intelligent** : Donn√©es mises en cache 5 minutes pour de meilleures performances
- **Interface responsive** : Compatible mobile et desktop

#### üéØ Acc√®s direct
- **URL locale** : http://localhost:8501
- **Th√®me InfoWatchdog** : Design coh√©rent avec logos ASCII
- **Sidebar de contr√¥le** : Param√®tres et informations de statut

### üì¶ Installation dashboard
```bash
# Installation des d√©pendances
pip install streamlit plotly pandas numpy

# Ou mise √† jour compl√®te
pip install -r requirements.txt
```

### üñ•Ô∏è Captures d'√©cran
Le dashboard affiche :
- üêï‚Äçü¶∫ **En-t√™te stylis√©** avec logo ASCII InfoWatchdog
- üìä **M√©triques temps r√©el** : Total articles, Reddit vs RSS, sources actives
- üìà **Graphiques interactifs** : Plotly pour visualisations dynamiques
- üì∞ **Feed articles r√©cents** : Liens directs, scores Reddit, m√©tadonn√©es
- üî• **Analyse tendances** : Sources populaires, subreddits actifs

---

## üìñ Documentation

- **[Configuration Airtable](docs/airtable_setup.md)** - Guide complet pour configurer Airtable
- **[Structure du projet](docs/structure.md)** - Architecture et organisation des fichiers

## üå± Sources de Donn√©es

### Reddit
- **Subreddits surveill√©s** : `environment`, `climate`, `sustainability`, `renewableenergy`, `ClimateChange`, `solar`, `wind`
- **Collecte** : Posts les plus populaires et r√©cents
- **Filtrage** : Pertinence environnementale automatique

### RSS Feeds
- **CleanTechnica** - Actualit√©s cleantech et √©nergies renouvelables
- **TreeHugger** - Environnement et d√©veloppement durable
- **GreenTech Media** - Technologies vertes
- **Yale Environment 360** - Analyses environnementales
- **Environmental Leader** - Business et environnement
- **Carbon Brief** - Changement climatique et √©nergie

## üìä Format des Donn√©es

Chaque article collect√© contient :
- **Titre** et **URL** source
- **Contenu/R√©sum√©** (extrait)
- **Source** et **Auteur**
- **Date de publication** et **Date de collecte**
- **Tags/Mots-cl√©s** automatiques
- **M√©tadonn√©es** sp√©cifiques (score Reddit, cat√©gories RSS, etc.)
- **Hash unique** pour √©viter les doublons

## üõ† Installation

### Pr√©requis
- Python 3.8+
- Compte Reddit (pour API)
- Compte Airtable

### 1. Cloner le projet
```bash
git clone https://github.com/yemal22/info-watchdog.git
cd info-watchdog
```

### 2. Installer les d√©pendances
```bash
pip install -r requirements.txt
```

### 3. Configuration des APIs

#### Reddit API
1. Allez sur [Reddit Apps](https://www.reddit.com/prefs/apps)
2. Cr√©ez une nouvelle application (type "script")
3. Notez le `client_id` et `client_secret`

#### Airtable
‚ö†Ô∏è **Important** : Les champs Airtable doivent √™tre cr√©√©s manuellement avant utilisation.

**Configuration rapide :**
1. Cr√©ez une base Airtable avec une table "Environmental_News"
2. Ajoutez les champs requis (voir [guide d√©taill√©](docs/airtable_setup.md))
3. R√©cup√©rez votre API key et Base ID

**Champs obligatoires :**
- `Title` (Single line text)
- `URL` (URL) 
- `Source` (Single line text)
- `Content` (Long text)
- `Author` (Single line text)
- `Published_Date` (Date)
- `Collected_Date` (Date)
- `Collector` (Single line text)
- `Hash` (Single line text)
- `Tags` (Single line text)

**Champs optionnels (Reddit) :**
- `Reddit_Score` (Number)
- `Reddit_Comments` (Number)
- `Subreddit` (Single line text)

‚û°Ô∏è **[Guide complet de configuration Airtable](docs/airtable_setup.md)**

### 4. Variables d'environnement
```bash
cp .env.example .env
```

√âditez le fichier `.env` :
```bash
# Reddit API
REDDIT_CLIENT_ID=votre_client_id
REDDIT_CLIENT_SECRET=votre_client_secret
REDDIT_USER_AGENT=InfoWatchdog/1.0

# Airtable
AIRTABLE_API_KEY=votre_api_key
AIRTABLE_BASE_ID=votre_base_id
AIRTABLE_TABLE_NAME=Environmental_News
```

## üöÄ Utilisation

### Test de configuration
```bash
python run.py --test-only
```

### Collecte unique
```bash
python run.py
```

### Afficher les statistiques
```bash
python run.py --stats
```

### Configuration personnalis√©e
```bash
python run.py --config config/custom.yaml
```

## ‚öôÔ∏è Configuration

Le fichier `config/config.yml` permet de personnaliser :

### Collecteurs Reddit
```yaml
collectors:
  reddit:
    enabled: true
    subreddits: ["environment", "climate", "sustainability"]
    limit: 50
    sort_type: "hot"  # hot, new, top, rising
```

### Flux RSS
```yaml
collectors:
  rss:
    enabled: true
    feeds:
      - url: "https://example.com/feed/"
        name: "Example News"
```

### Planification
```yaml
schedule:
  interval: 3600  # Collecte toutes les heures
```

## üïê Automatisation et Planification

InfoWatchdog inclut des scripts pour configurer automatiquement la collecte p√©riodique selon votre syst√®me d'exploitation.

### Script de configuration automatique

```bash
python setup_scheduler.py
```

**Fonctionnalit√©s :**
- ‚úÖ D√©tection automatique du syst√®me d'exploitation
- ‚úÖ Configuration de t√¢ches cron (Linux/macOS)
- ‚úÖ Configuration de services systemd (Linux)
- ‚úÖ Configuration du Planificateur de t√¢ches (Windows)
- ‚úÖ D√©tection automatique de l'environnement virtuel Python
- ‚úÖ G√©n√©ration automatique des chemins et logs

### V√©rification et gestion

```bash
python check_scheduler.py
```

**Fonctionnalit√©s :**
- üîç V√©rification des t√¢ches planifi√©es existantes
- üìÑ Consultation des logs d'ex√©cution
- üß™ Test d'ex√©cution manuelle
- üóëÔ∏è Suppression des t√¢ches planifi√©es

### Intervalles de collecte disponibles

- **Hourly** : Toutes les heures (recommand√©)
- **Daily** : Une fois par jour (8h du matin)
- **Twice daily** : Deux fois par jour (8h et 20h)
- **Every 6h** : Toutes les 6 heures

### Configuration manuelle alternative

#### Linux/macOS (cron)
```bash
# √âdite le crontab
crontab -e

# Ajoute cette ligne pour une collecte horaire
0 * * * * cd /path/to/InfoWatchdog && python run.py >> logs/cron.log 2>&1
```

#### Linux (systemd)
Cr√©ez les fichiers de service avec `setup_scheduler.py` ou manuellement :

```bash
sudo systemctl enable infowatchdog.timer
sudo systemctl start infowatchdog.timer
```

#### Windows (PowerShell)
Le script g√©n√®re automatiquement un fichier `setup_windows_task.ps1` :

```powershell
# Ex√©cuter en tant qu'Administrateur
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
.\setup_windows_task.ps1
```

### Logs et monitoring

Les logs d'ex√©cution automatique sont sauvegard√©s dans :
- `logs/cron.log` - Logs des ex√©cutions planifi√©es
- `logs/wrapper.log` - Logs du script wrapper
- `logs/infowatchdog.log` - Logs d√©taill√©s de l'application

```bash
# Voir les logs r√©cents
tail -f logs/cron.log

# V√©rifier le statut
python check_scheduler.py
```

## üìã Structure du Projet

```
InfoWatchdog/
‚îú‚îÄ‚îÄ üìÑ run.py                      # Script de lancement principal
‚îú‚îÄ‚îÄ üìÑ run_dashboard.py            # Lanceur du dashboard Streamlit
‚îú‚îÄ‚îÄ üìä dashboard_streamlit.py      # Dashboard interactif Streamlit
‚îú‚îÄ‚îÄ üìÑ setup_scheduler.py          # Configuration automatique des t√¢ches
‚îú‚îÄ‚îÄ üìÑ check_scheduler.py          # V√©rification et gestion des t√¢ches
‚îú‚îÄ‚îÄ üß™ test_airtable.py           # Tests de connexion Airtable
‚îú‚îÄ‚îÄ üìÑ requirements.txt            # D√©pendances Python
‚îú‚îÄ‚îÄ üìÑ LICENSE                     # Licence MIT
‚îú‚îÄ‚îÄ üìÑ README.md                   # Documentation principale
‚îú‚îÄ‚îÄ üìÑ .env.example               # Template variables d'environnement
‚îú‚îÄ‚îÄ üìÑ infowatchdog.log           # Logs principaux
‚îÇ
‚îú‚îÄ‚îÄ üìÅ src/                       # Code source principal
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ main.py                # Gestionnaire principal
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ collectors/            # Collecteurs de donn√©es
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ base_collector.py  # Classe abstraite collecteur
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ reddit_collector.py # Collecteur Reddit
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ rss_collector.py   # Collecteur RSS
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ processors/            # Traitement des donn√©es
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ __init__.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìÅ storage/               # Syst√®mes de stockage
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÑ base_storage.py    # Interface abstraite stockage
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÑ airtable_storage.py # Stockage Airtable
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ üìÅ utils/                 # Utilitaires
‚îÇ       ‚îú‚îÄ‚îÄ üìÑ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ üìÑ logo.py            # G√©n√©rateur de logos ASCII
‚îÇ
‚îú‚îÄ‚îÄ üìÅ config/                    # Configuration
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ config.yml             # Configuration principale
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ keywords.json          # Mots-cl√©s environnementaux
‚îÇ
‚îú‚îÄ‚îÄ üìÅ docs/                      # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ airtable_setup.md      # Guide configuration Airtable
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ sources.md             # Documentation Reddit & RSS
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ structure.md           # Architecture du projet
‚îÇ
‚îú‚îÄ‚îÄ üìÅ assets/                    # Ressources
‚îÇ   ‚îú‚îÄ‚îÄ üñºÔ∏è logo.svg              # Logo anim√© InfoWatchdog
‚îÇ   ‚îî‚îÄ‚îÄ üñºÔ∏è logo-static.svg       # Logo statique
‚îÇ
‚îî‚îÄ‚îÄ üìÅ logs/                      # Journaux d'ex√©cution
    ‚îî‚îÄ‚îÄ üìÑ cron.log               # Logs des t√¢ches planifi√©es
```

### üèóÔ∏è Architecture modulaire

#### üîß **Scripts principaux**
- `run.py` : Point d'entr√©e principal pour collecte
- `run_dashboard.py` : Lancement automatique du dashboard
- `dashboard_streamlit.py` : Interface web interactive
- `setup_scheduler.py` : Configuration automatique des t√¢ches
- `check_scheduler.py` : Monitoring et gestion

#### üìä **Code source (`src/`)**
- **Collecteurs** : Modules sp√©cialis√©s par source (Reddit, RSS)
- **Stockage** : Interface abstraite extensible (Airtable, futur Google Sheets)
- **Processors** : Traitement et transformation des donn√©es
- **Utils** : Outils transversaux (logos, helpers)

#### ‚öôÔ∏è **Configuration (`config/`)**
- `config.yml` : Param√®tres principaux (subreddits, flux RSS, intervalles)
- `keywords.json` : Dictionnaire de mots-cl√©s environnementaux

#### üìö **Documentation (`docs/`)**
- `airtable_setup.md` : Guide d√©taill√© de configuration Airtable
- `sources.md` : Explications Reddit & RSS, justifications techniques
- `structure.md` : Architecture d√©taill√©e du syst√®me

#### üé® **Assets (`assets/`)**
- Logos SVG pour interface et documentation
- Ressources graphiques du projet

#### üìù **Logs (`logs/`)**
- `cron.log` : Logs des ex√©cutions automatiques
- `infowatchdog.log` : Logs d√©taill√©s de l'application

## üéõ Choix Techniques

### Architecture Modulaire
- **Collecteurs** : Facilement extensibles pour nouvelles sources
- **Stockage** : Interface abstraite (Airtable, Google Sheets, etc.)
- **Configuration** : YAML pour simplicit√© et lisibilit√©

### Gestion des Doublons
- Hash MD5 bas√© sur titre + URL
- Cache en m√©moire pour performances
- V√©rification avant stockage

### Filtrage Intelligent
- Mots-cl√©s environnementaux pr√©d√©finis
- Exclusion des contenus non-pertinents
- M√©tadonn√©es sp√©cifiques par source

### Robustesse
- Gestion d'erreur par collecteur
- Logs d√©taill√©s
- Tests de connexion
- Traitement par lots

## üìà M√©triques et Monitoring

Le syst√®me fournit :
- Nombre d'articles collect√©s par cycle
- R√©partition par source
- Taux de r√©ussite du stockage
- Dur√©e des cycles de collecte
- Statistiques de doublons

## üîß D√©veloppement

### Ajouter un nouveau collecteur
1. H√©riter de `BaseCollector`
2. Impl√©menter la m√©thode `collect()`
3. Ajouter la configuration dans `config.yml`
4. Enregistrer dans `main.py`

### Ajouter un nouveau syst√®me de stockage
1. H√©riter de `BaseStorage`
2. Impl√©menter les m√©thodes abstraites
3. Ajouter la configuration

## üìù Logs

Les logs sont sauvegard√©s dans `infowatchdog.log` avec :
- Horodatage
- Niveau (INFO, ERROR, WARNING)
- Source (collector, storage)
- Message d√©taill√©

## üêõ D√©pannage

### Erreur Reddit API
- V√©rifiez vos credentials dans `.env`
- Respectez les limites de taux Reddit

### Erreur Airtable
- V√©rifiez votre API key et Base ID
- Assurez-vous que la table a tous les champs requis

### Aucun article collect√©
- V√©rifiez la connectivit√© internet
- Testez avec `--test-only`
- Consultez les logs

## üìÑ Licence

MIT License - Voir le fichier LICENSE pour plus de d√©tails.

## ü§ù Contribution

1. Fork le projet
2. Cr√©ez une branche feature (`git checkout -b feature/amazing-feature`)
3. Committez vos changements (`git commit -m 'Add amazing feature'`)
4. Push sur la branche (`git push origin feature/amazing-feature`)
5. Ouvrez une Pull Request